<main>
  <div class="card">
    <header>
      <h1>Invitations</h1>
    </header>

    <div class="card-content">
      <%= notice %>

      <table>
        <thead>
          <tr>
            <th>Email</th>
            <th colspan="3"></th>
          </tr>
        </thead>

        <tbody>
          <% @team.invitations.unused.each do |invitation| %>
            <tr>
              <td><%= invitation.email %></td>
              <td><%= link_to 'Destroy', invitation, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            </tr>
          <% end %>
        </tbody>
      </table>

      <%= render 'form', form: @invitation_form %>


      <% if @team.connected_to_slack? %>

      <h1>Invitavle</h1>
        <% @slack_team_users.invitable.each do |slack_user| %>
          <%= render "slack_user_to_invite", slack_user: slack_user %>
        <% end %>

        <h1>With open invitation</h1>

        <% @slack_team_users.with_open_invitation.each do |slack_user| %>
          <%= render "slack_user_to_invite", slack_user: slack_user %>
        <% end %>

        <h1>With accepted invitation</h1>

        <% @slack_team_users.with_accepted_invitation.each do |slack_user| %>
          <%= render "slack_user_to_invite", slack_user: slack_user %>
        <% end %>

      <% else %>
        <%= link_to "Add Slack Team-Members", user_slack_button_omniauth_authorize_url(subdomain: ENV["DEFAULT_SUBDOMAIN"], team_id: @team.id) %>
      <% end %>


      <div class="card-actions">
        <%= link_to 'Back to Team', team_path %>
      </div>
    </div>
  </div>
</main>
